<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>快速上手，教你如何将 ChatGPT 接入到微信公众号 | 小孙同学</title><meta name="keywords" content="开发,热门,AI,教程"><meta name="author" content="小孙同学"><meta name="copyright" content="小孙同学"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#18171d"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="快速上手，教你如何将 ChatGPT 接入到微信公众号"><meta name="application-name" content="快速上手，教你如何将 ChatGPT 接入到微信公众号"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#18171d"><meta property="og:type" content="article"><meta property="og:title" content="快速上手，教你如何将 ChatGPT 接入到微信公众号"><meta property="og:url" content="https://blog.sunguoqi.com/posts/e78a2007/index.html"><meta property="og:site_name" content="小孙同学"><meta property="og:description" content="成果演示基础问答 查看详情                                                             代码解读 查看详情                                                             代码转换 查"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://files.sunguoqi.com/images/202311220232967.webp"><meta property="article:author" content="小孙同学"><meta property="article:tag" content="前端，摄影，旅行，骑行，科技，生活，编程，技术，程序员"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://files.sunguoqi.com/images/202311220232967.webp"><meta name="description" content="成果演示基础问答 查看详情                                                             代码解读 查看详情                                                             代码转换 查"><link rel="shortcut icon" href="/images/favicon.png"><link rel="canonical" href="https://blog.sunguoqi.com/posts/e78a2007/"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: {"enable":true,"title":"与数百名博主共同进步","addFriendPlaceholder":"昵称：\n网站地址：\n头像图片：\n站点描述："},
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"XiaoAi","mode":"local","switchBtn":true,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"8d218e5143e4aac30720","Referer":"https://blog.sunguoqi.com/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 宝～请不要离开！","backTitle":"♪(^∇^*) 欢迎回来～我爱你！"},
  LA51: {"enable":true,"ck":"3F6cJC4GAXse6laY","LingQueMonitorID":null},
  greetingBox: undefined,
  twikooEnvId: 'https://twikoo-sun.netlify.app/.netlify/functions/twikoo',
  commentBarrageConfig:{"enable":true,"maxBarrage":1,"barrageTime":4000,"accessToken":"208a201671d64a7fa1ffd95d97b93d2b","mailMd5":"a4066de3e872d474ad577fc50af1c5bf"},
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":1},
  friends_vue_info: {"apiurl":"https://friends.anheyu.com/"},
  navMusic: true,
  mainTone: {"mode":"both","api":"https://api.qjqq.cn/api/Imgcolor?img=","cover_change":true},
  authorStatus: {"skills":["🤖️ 数码科技爱好者","🔍 分享与热心帮助","🏠 智能家居小能手","🔨 设计开发一条龙","🤝 专修交互与设计","🏃 脚踏实地行动派","🧱 团队小组发动机","💢 壮汉人狠话不多"]},
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: 小孙同学","link":"链接: ","source":"来源: 小孙同学","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#333333","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: true,
  shortcutKey: undefined,
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: '小孙同学',
  title: '快速上手，教你如何将 ChatGPT 接入到微信公众号',
  postAI: '这篇文章介绍了小孙同学展示的成果。其中包括基础问答、代码解读、代码转换、错误修正、情感分析、项目分类、名字生成器和时间复杂度计算等内容。文章还提供了关于 OpenAI API 和 WeRoBot 的使用指南和示例应用介绍。最后，文章提到了 ChatGPT 的相关内容。',
  pageFillDescription: '成果演示, 基础问答, 代码解读, 代码转换, 错误修正, 情感分析, 项目分类, 名字生成器, 时间复杂度计算, 友情提示, OpenAI API, 新建一个 Python 项目, 新建一个 API key, 安装 openai 依赖, 安装失败, 安装成功, 查看示例应用, 本地调试, 代码解读, WeRoBot, 安装 werobot 依赖, 新建 Python 脚本, 运行该脚本, 服务测试, 反向代理, 公众号配置, Hello World !, 数据转发原理, ChatGPT amp WeRoBot, 编写代码, 进程管理, 运行服务, 注意事项, 科学上网, 账号注册, 微信公众号自定义菜单及关键词回复失效, 该公众号提供的服务出现故障请稍后再试！成果演示基础问答查看详情代码解读查看详情代码转换查看详情错误修正查看详情情感分析查看详情项目分类查看详情名字生成器查看详情时间复杂度计算查看详情友情提示本教程假定您已经拥有以下资源一个微信公众号一个账号一台可访问外网的服务器一个域名最好有没有也可以您最好已经掌握以下技能编程基础一定的开发及服务端运维经验在本节您将学会如何使用来调用新建一个项目使用或其他集成开发环境创建一个项目新建一个点击上方链接创建一个密钥保存此密钥以便后续使用安装依赖在中打开本地终端并输入以下命令安装依赖包安装失败请确保您的电脑可以正常访问境外网络否则可能会安装失败安装成功在终端中输入以下命令查看依赖包是否已经安装成功终端输出如下示例查看示例应用打开上方链接查看官网所列出的示例应用此页面包含了的主要应用场景以最简单的问答应用为例点击后弹出如下界面之后点击按钮点击查看本应用的示例代码复制此代码并粘贴至项目文件中本地调试基于示例修改后的代码如下记得修改的值是这个世界上最好的语言吗此参数定义了您的问题终止符运行该程序控制台输出如下此处省略部分字符进程已结束退出代码即为我们问题的答案在加入下面这行代码重新运行此脚本程序运行结果最终如下代码解读各参数的含义请查阅官方文档本程序的代码逻辑比较简单请读者自行理解项目地址是一个微信公众号开发框架在本节您将使用框架创建一个程序当您的公众号后台收到用户发来的消息时程序会自动调用并发送如下图所示安装依赖使用工具打开服务器终端并输入以下命令新建脚本使用打开文件复制以下内容后保存让服务器监听在运行该脚本运行该脚本之前请确保您服务器的端口已开放输入以下命令运行此脚本终端输出如下服务测试在浏览器中输入您服务器的公网端口号访问此服务如果您看到如下界面说明本服务已部署成功反向代理由于微信公众号的后台接口只支持和端口故需要配置反向代理您可以使用宝塔面板或配置反向代理此处不做过多讲解当然如果您服务器的或端口没有被占用的话您可以直接将运行在该端口下您只需要修改文件中该行代码即可公众号配置打开微信公众平台点我在设置与开发选项卡中点击基本配置输入您反向代理后的域名设置您的令牌消息加密点击自动生成加密方式设置成明文请注意这里的令牌必须和中的保持一致输入好配置后我们点击提交然后启用该配置即可不出意外的话当用户在您的后台发送任何消息时后台便会自动发送数据转发原理如上图所示当在微信公众号后台发送消息时数据首先会发送到微信服务器上如果公众号后台配置了接口信息那么微信服务器便会将数据转发到开发者服务器由开发者服务器做出响应再经过微信服务器发送到微信公众号客户端首先恭喜您已经完成了上面两个小节的内容在本节我们将会把和融合成一个脚本当用户输入信息时后台响应的不再是而是经过处理后的结果编写代码在服务器中新建文件并将以下代码复制到该文件中你的你的本程序将在端口运行进程管理当我们关掉会话连接时我们在此会话中运行的进程便会被杀死如何解决这个问题呢这里推荐大家使用对进程进行管理常用命令如下安装系统安装命令安装命令创建新建查看查看列表进入进入删除在当前下输入删除该退出在当前下输入先后退出该杀死删除指定为待删除的运行服务确保您服务器的端口端口号以实际开发为准已开放且没被占用在终端中输入以下命令创建一个进入后输入以下命令运行即可注意事项科学上网由于敏感原因请确保您的电脑和服务器都可以正常访问境外网络账号注册账号注册可参考此教程注册保姆级攻略绝对有效知乎微信公众号自定义菜单及关键词回复失效由于我们使用了自定义的接口便无法再使用官方提供的自定义菜单及关键词回复等功能二者功能实现可参考文档自行开发该公众号提供的服务出现故障请稍后再试微信官方为了优化用户体验对接口制定了如下规则微信服务器在五秒内如果收不到开发者服务器的响应便会主动断掉连接并且重新发起请求总共重试三次此规则会对本程序带来一定的限制如果用户输入的文本较为复杂或者较难处理的话服务器的响应时间通常会超过客户端便会收到该公众号提供的服务出现故障请稍后再试的消息未认证的公众号暂时无法突破此限制已认证的公众号可以采取被动模式接收消息待程序处理完成后使用主动模式进行发送消息的方法突破此限制对于用户而言建议您采用英语进行提问并且精炼您的语言以避免处理复杂文本而超时',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-12-27 14:27:26',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><script src="https://webapi.amap.com/loader.js"></script><meta name="generator" content="Hexo 7.0.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/rss.xml" title="小孙同学" type="application/rss+xml">
</head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="/images/avatar.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网站</div><div class="back-menu-list"><a class="back-menu-item" href="https://blog.sunguoqi.com/" title="博客"><img class="back-menu-item-icon" src="/images/favicon.png" alt="博客"/><span class="back-menu-item-text">博客</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://brain.sunguoqi.com/" title="外脑"><img class="back-menu-item-icon" src="https://files.sunguoqi.com/images/202312110649164.webp" alt="外脑"/><span class="back-menu-item-text">外脑</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://chat.sunguoqi.com/" title="Chat"><img class="back-menu-item-icon" src="https://files.sunguoqi.com/images/202312110652765.webp" alt="Chat"/><span class="back-menu-item-text">Chat</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">小孙同学</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li><li><a class="site-page child faa-parent animated-hover" target="_blank" rel="noopener" href="https://brain.sunguoqi.com"><i class="anzhiyufont anzhiyu-icon-fire faa-tada" style="font-size: 0.9em;"></i><span> 外脑</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 生活</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/essay/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-bulb"></use></svg><span> 说说</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-images"></use></svg><span> 相册</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/music/?id=4863092223&amp;server=netease"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐</span></a></li><li><a class="site-page child faa-parent animated-hover" target="_blank" rel="noopener" href="https://run.sunguoqi.com"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-run"></use></svg><span> 运动</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 工具</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" target="_blank" rel="noopener" href="https://v6.51.la/s/Jvt3I1rYnN7Z9TW"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-data"></use></svg><span> 流量统计</span></a></li><li><a class="site-page child faa-parent animated-hover" target="_blank" rel="noopener" href="https://stats.uptimerobot.com/4oYGZiYEQZ"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-check"></use></svg><span> 服务监控</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/equipment/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-bag"></use></svg><span> 日常装备</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/collect/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-box"></use></svg><span> 收藏推荐</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-link"></use></svg><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-pyq"></use></svg><span> 朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-comments"></use></svg><span> 留言板</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/about/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-about"></use></svg><span> 关于我</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button only-home" id="travellings_button" title="随机前往一个开往项目网站"><a class="site-page" onclick="anzhiyu.totraveling()" title="随机前往一个开往项目网站" href="javascript:void(0);" rel="external nofollow" data-pjax-state="external"><i class="anzhiyufont anzhiyu-icon-train"></i></a></div><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://files.sunguoqi.com/images/202311250236396.webp" target="_blank"><img class="post-qr-code-img" alt="微信" src="https://files.sunguoqi.com/images/202311250236396.webp"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://files.sunguoqi.com/images/202311250235039.webp" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="https://files.sunguoqi.com/images/202311250235039.webp"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/21-%E5%B2%81/" style="font-size: 1.05rem;">21 岁<sup>1</sup></a><a href="/tags/22-%E5%B2%81/" style="font-size: 1.05rem;">22 岁<sup>1</sup></a><a href="/tags/AI/" style="font-size: 1.05rem;">AI<sup>1</sup></a><a href="/tags/Flask/" style="font-size: 1.05rem;">Flask<sup>1</sup></a><a href="/tags/GitHub/" style="font-size: 1.05rem;">GitHub<sup>1</sup></a><a href="/tags/%E5%85%AC%E4%BC%97%E5%8F%B7/" style="font-size: 1.05rem;">公众号<sup>1</sup></a><a href="/tags/%E5%8D%9A%E5%AE%A2/" style="font-size: 1.05rem;">博客<sup>1</sup></a><a href="/tags/%E5%A4%96%E8%84%91/" style="font-size: 1.05rem;">外脑<sup>1</sup></a><a href="/tags/%E5%A5%BD%E7%89%A9%E6%8E%A8%E8%8D%90/" style="font-size: 1.05rem;">好物推荐<sup>1</sup></a><a href="/tags/%E5%AD%A6%E4%B9%A0/" style="font-size: 1.05rem;">学习<sup>1</sup></a><a href="/tags/%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/" style="font-size: 1.05rem;">年终总结<sup>1</sup></a><a href="/tags/%E5%BC%80%E5%8F%91/" style="font-size: 1.05rem;">开发<sup>2</sup></a><a href="/tags/%E6%84%9F%E6%82%9F/" style="font-size: 1.05rem;">感悟<sup>3</sup></a><a href="/tags/%E6%88%90%E9%95%BF/" style="font-size: 1.05rem;">成长<sup>1</sup></a><a href="/tags/%E6%91%84%E5%BD%B1/" style="font-size: 1.05rem;">摄影<sup>1</sup></a><a href="/tags/%E6%95%99%E7%A8%8B/" style="font-size: 1.05rem;">教程<sup>3</sup></a><a href="/tags/%E6%97%85%E8%A1%8C/" style="font-size: 1.05rem;">旅行<sup>1</sup></a><a href="/tags/%E7%83%AD%E9%97%A8/" style="font-size: 1.05rem;">热门<sup>2</sup></a><a href="/tags/%E7%94%9F%E6%97%A5/" style="font-size: 1.05rem;">生日<sup>2</sup></a><a href="/tags/%E7%94%9F%E6%B4%BB/" style="font-size: 1.05rem;">生活<sup>5</sup></a><a href="/tags/%E7%B2%BE%E9%80%89/" style="font-size: 1.05rem;">精选<sup>1</sup></a><a href="/tags/%E7%BB%88%E7%AB%AF/" style="font-size: 1.05rem;">终端<sup>1</sup></a><a href="/tags/%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB/" style="font-size: 1.05rem;">网络爬虫<sup>1</sup></a><a href="/tags/%E7%BE%8E%E5%8C%96/" style="font-size: 1.05rem;">美化<sup>2</sup></a><a href="/tags/%E8%BF%90%E8%90%A5/" style="font-size: 1.05rem;">运营<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/01/"><span class="card-archive-list-date">一月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/12/"><span class="card-archive-list-date">十二月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/07/"><span class="card-archive-list-date">七月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/03/"><span class="card-archive-list-date">三月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/02/"><span class="card-archive-list-date">二月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/01/"><span class="card-archive-list-date">一月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">5</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/02/"><span class="card-archive-list-date">二月 2022</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/12/"><span class="card-archive-list-date">十二月 2021</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item on" id="consoleCommentBarrage" onclick="anzhiyu.switchCommentBarrage()" title="热评开关"><a class="commentBarrage"><i class="anzhiyufont anzhiyu-icon-message"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AE%9E%E7%94%A8%E6%95%99%E7%A8%8B/" itemprop="url">实用教程</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/%E5%BC%80%E5%8F%91/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>开发</span></a><a class="article-meta__tags" href="/tags/%E7%83%AD%E9%97%A8/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>热门</span></a><a class="article-meta__tags" href="/tags/AI/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>AI</span></a><a class="article-meta__tags" href="/tags/%E6%95%99%E7%A8%8B/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>教程</span></a></span></div></div><h1 class="post-title" itemprop="name headline">快速上手，教你如何将 ChatGPT 接入到微信公众号</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2023-01-28T16:00:00.000Z" title="发表于 2023-01-29 00:00:00">2023-01-29</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2023-12-27T06:27:26.772Z" title="更新于 2023-12-27 14:27:26">2023-12-27</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">2.2k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>7分钟</span></span><span class="post-meta-separator"></span><span id="" data-flag-title="快速上手，教你如何将 ChatGPT 接入到微信公众号"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="twikoo_visitors" title="访问量"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为广州"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>广州</span><span class="post-meta-separator"></span><span class="post-meta-commentcount"><i class="anzhiyufont anzhiyu-icon-comments post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/posts/e78a2007/#post-comment" tabindex="-1"><span id="twikoo-count"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></a></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://files.sunguoqi.com/images/202311220232967.webp"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><div class="post-ai-description"><div class="ai-title"><i class="anzhiyufont anzhiyu-icon-bilibili"></i><div class="ai-title-text">AI-摘要</div><div id="ai-Toggle">切换</div><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right"></i><i class="anzhiyufont anzhiyu-icon-circle-dot" title="朗读摘要"></i><div id="ai-tag">XiaoAi GPT</div></div><div class="ai-explanation">AI初始化中...</div><div class="ai-btn-box"><div class="ai-btn-item">介绍自己 🙈</div><div class="ai-btn-item">生成本文简介 👋</div><div class="ai-btn-item">推荐相关文章 📖</div><div class="ai-btn-item">前往主页 🏠</div><div class="ai-btn-item" id="go-tianli-blog">前往爱发电购买</div></div><script data-pjax src="/js/anzhiyu/ai_abstract.js"></script></div><article class="post-content" id="article-container" itemscope itemtype="https://blog.sunguoqi.com/posts/e78a2007/"><header><a class="post-meta-categories" href="/categories/%E5%AE%9E%E7%94%A8%E6%95%99%E7%A8%8B/" itemprop="url">实用教程</a><a href="/tags/%E5%BC%80%E5%8F%91/" tabindex="-1" itemprop="url">开发</a><a href="/tags/%E7%83%AD%E9%97%A8/" tabindex="-1" itemprop="url">热门</a><a href="/tags/AI/" tabindex="-1" itemprop="url">AI</a><a href="/tags/%E6%95%99%E7%A8%8B/" tabindex="-1" itemprop="url">教程</a><h1 id="CrawlerTitle" itemprop="name headline">快速上手，教你如何将 ChatGPT 接入到微信公众号</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">小孙同学</span><time itemprop="dateCreated datePublished" datetime="2023-01-28T16:00:00.000Z" title="发表于 2023-01-29 00:00:00">2023-01-29</time><time itemprop="dateCreated datePublished" datetime="2023-12-27T06:27:26.772Z" title="更新于 2023-12-27 14:27:26">2023-12-27</time></header><h2 id="成果演示"><a href="#成果演示" class="headerlink" title="成果演示"></a>成果演示</h2><h3 id="基础问答"><a href="#基础问答" class="headerlink" title="基础问答"></a>基础问答</h3><details class="folding-tag"><summary> 查看详情 </summary>
              <div class="content">
              <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://files.sunguoqi.com/images/202311250121850.webp">
              </div>
            </details>

<h3 id="代码解读"><a href="#代码解读" class="headerlink" title="代码解读"></a>代码解读</h3><details class="folding-tag"><summary> 查看详情 </summary>
              <div class="content">
              <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://files.sunguoqi.com/images/202311250122187.webp">
              </div>
            </details>

<h3 id="代码转换"><a href="#代码转换" class="headerlink" title="代码转换"></a>代码转换</h3><details class="folding-tag"><summary> 查看详情 </summary>
              <div class="content">
              <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://files.sunguoqi.com/images/202311250122303.webp">
              </div>
            </details>

<h3 id="错误修正"><a href="#错误修正" class="headerlink" title="错误修正"></a>错误修正</h3><details class="folding-tag"><summary> 查看详情 </summary>
              <div class="content">
              <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://files.sunguoqi.com/images/202311250122231.webp">
              </div>
            </details>

<h3 id="情感分析"><a href="#情感分析" class="headerlink" title="情感分析"></a>情感分析</h3><details class="folding-tag"><summary> 查看详情 </summary>
              <div class="content">
              <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://files.sunguoqi.com/images/202311250123269.webp">
              </div>
            </details>

<h3 id="项目分类"><a href="#项目分类" class="headerlink" title="项目分类"></a>项目分类</h3><details class="folding-tag"><summary> 查看详情 </summary>
              <div class="content">
              <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://files.sunguoqi.com/images/202311250123372.webp">
              </div>
            </details>


<h3 id="名字生成器"><a href="#名字生成器" class="headerlink" title="名字生成器"></a>名字生成器</h3><details class="folding-tag"><summary> 查看详情 </summary>
              <div class="content">
              <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://files.sunguoqi.com/images/202311250123039.webp">
              </div>
            </details>


<h3 id="时间复杂度计算"><a href="#时间复杂度计算" class="headerlink" title="时间复杂度计算"></a>时间复杂度计算</h3><details class="folding-tag"><summary> 查看详情 </summary>
              <div class="content">
              <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://files.sunguoqi.com/images/202311250124645.webp">
              </div>
            </details>

<h2 id="友情提示"><a href="#友情提示" class="headerlink" title="友情提示"></a>友情提示</h2><p>本教程假定您已经拥有以下资源</p>
<ul>
<li>一个微信公众号</li>
<li>一个 OpenAI 账号</li>
<li>一台可访问外网的服务器</li>
<li>一个域名 (最好有，没有也可以)</li>
</ul>
<p>您最好已经掌握以下技能</p>
<ul>
<li>Python 编程基础</li>
<li>一定的 Web 开发及服务端运维经验</li>
</ul>
<h2 id="OpenAI-API"><a href="#OpenAI-API" class="headerlink" title="OpenAI API"></a>OpenAI API</h2><p>在本节，您将学会如何使用 Python 来调用 OpenAI API。</p>
<h3 id="新建一个-Python-项目"><a href="#新建一个-Python-项目" class="headerlink" title="新建一个 Python 项目"></a>新建一个 Python 项目</h3><p>使用 PyCharm 或其他集成开发环境创建一个 Python 项目。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://files.sunguoqi.com/images/202311250132445.webp">

<h3 id="新建一个-API-key"><a href="#新建一个-API-key" class="headerlink" title="新建一个 API key"></a>新建一个 API key</h3><p><a target="_blank" rel="noopener" href="https://beta.openai.com/account/api-keys">Account API Keys - OpenAI API</a></p>
<p>点击上方链接创建一个密钥，保存此密钥以便后续使用。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://files.sunguoqi.com/images/202311250133137.webp">

<h3 id="安装-openai-依赖"><a href="#安装-openai-依赖" class="headerlink" title="安装 openai 依赖"></a>安装 openai 依赖</h3><p>在 Pycharm 中打开本地终端并输入以下命令安装 openai 依赖包。</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">pip install openai</span><br></pre></td></tr></tbody></table></figure>

<h4 id="安装失败"><a href="#安装失败" class="headerlink" title="安装失败"></a>安装失败</h4><p>请确保您的电脑可以正常访问境外网络，否则可能会安装失败。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://files.sunguoqi.com/images/202311250133200.webp">

<h4 id="安装成功"><a href="#安装成功" class="headerlink" title="安装成功"></a>安装成功</h4><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://files.sunguoqi.com/images/202311250133044.webp">

<p>在终端中输入以下命令查看<strong>openai</strong>依赖包是否已经安装成功。</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">pip list</span><br></pre></td></tr></tbody></table></figure>

<p>终端输出如下（示例）。</p>
<figure class="highlight txt"><table><tbody><tr><td class="code"><pre><span class="line">aiohttp            3.8.3</span><br><span class="line">aiosignal          1.3.1</span><br><span class="line">async-timeout      4.0.2</span><br><span class="line">attrs              22.2.0</span><br><span class="line">certifi            2022.12.7</span><br><span class="line">charset-normalizer 2.1.1</span><br><span class="line">colorama           0.4.6</span><br><span class="line">frozenlist         1.3.3</span><br><span class="line">idna               3.4</span><br><span class="line">multidict          6.0.4</span><br><span class="line">openai             0.26.4</span><br><span class="line">pip                22.3.1</span><br><span class="line">requests           2.28.2</span><br><span class="line">setuptools         65.5.1</span><br><span class="line">tqdm               4.64.1</span><br><span class="line">urllib3            1.26.14</span><br><span class="line">wheel              0.38.4</span><br><span class="line">yarl               1.8.2</span><br></pre></td></tr></tbody></table></figure>


<h3 id="查看示例应用"><a href="#查看示例应用" class="headerlink" title="查看示例应用"></a>查看示例应用</h3><p><a target="_blank" rel="noopener" href="https://beta.openai.com/examples">Examples - OpenAI API</a></p>
<p>打开上方链接，查看 OpenAI 官网所列出的示例应用，此页面包含了 ChatGPT 的主要应用场景。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://files.sunguoqi.com/images/202311250134339.webp">

<p>以最简单的问答应用为例，点击<strong>Q&amp;A</strong>后弹出如下界面，之后点击<strong>Open in Playground</strong>按钮。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://files.sunguoqi.com/images/202311250134892.webp">

<p>点击<strong>View code</strong>查看本应用的示例代码。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://files.sunguoqi.com/images/202311250134886.webp">

<p>复制此代码并粘贴至项目文件<strong>main.py</strong>中。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://files.sunguoqi.com/images/202311250135412.webp">

<h3 id="本地调试"><a href="#本地调试" class="headerlink" title="本地调试"></a>本地调试</h3><p>基于示例，修改后的代码如下，记得修改<strong>api_key</strong>的值。</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"><span class="keyword">import</span> openai  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># openai.api_key = os.getenv("OPENAI_API_KEY")  </span></span><br><span class="line">openai.api_key = <span class="string">"sk-6mWGxEw**************NqKWDXWRRaLxXAPxfEmO"</span>  </span><br><span class="line">  </span><br><span class="line">response = openai.Completion.create(  </span><br><span class="line">    model=<span class="string">"text-davinci-003"</span>,  </span><br><span class="line">    prompt=<span class="string">"Python 是这个世界上最好的语言吗？"</span>,  </span><br><span class="line">    temperature=<span class="number">0</span>,  </span><br><span class="line">    max_tokens=<span class="number">1000</span>,  </span><br><span class="line">    top_p=<span class="number">1</span>,  </span><br><span class="line">    frequency_penalty=<span class="number">0</span>,  </span><br><span class="line">    presence_penalty=<span class="number">0</span>,  </span><br><span class="line">    <span class="comment"># 此参数定义了您的问题终止符 </span></span><br><span class="line">    <span class="comment"># stop=["\n"]   </span></span><br><span class="line">)  </span><br><span class="line">  </span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></tbody></table></figure>

<p>运行该程序，控制台输出如下。</p>
<figure class="highlight txt"><table><tbody><tr><td class="code"><pre><span class="line">{</span><br><span class="line">  "choices": [</span><br><span class="line">    {</span><br><span class="line">      "finish_reason": "length",</span><br><span class="line">      "index": 0,</span><br><span class="line">      "logprobs": null,</span><br><span class="line">      "text": "\n\n\u4e0d\u662f{此处省略部分字符}\u3002Python\u662"</span><br><span class="line">    }</span><br><span class="line">  ],</span><br><span class="line">  "created": 1674910885,</span><br><span class="line">  "id": "cmpl-6df7dn3shXPJwGmpeTQotLwBW9cPw",</span><br><span class="line">  "model": "text-davinci-003",</span><br><span class="line">  "object": "text_completion",</span><br><span class="line">  "usage": {</span><br><span class="line">    "completion_tokens": 99,</span><br><span class="line">    "prompt_tokens": 26,</span><br><span class="line">    "total_tokens": 125</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">进程已结束，退出代码 0</span><br></pre></td></tr></tbody></table></figure>

<p><code>text</code>即为我们问题的答案，在<strong>main.py</strong>加入下面这行代码。</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(response.choices[<span class="number">0</span>].text)</span><br></pre></td></tr></tbody></table></figure>

<p>重新运行此脚本，程序运行结果最终如下。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://files.sunguoqi.com/images/202311250140641.webp">

<h3 id="代码解读-1"><a href="#代码解读-1" class="headerlink" title="代码解读"></a>代码解读</h3><p>各参数的含义请查阅官方文档：<a target="_blank" rel="noopener" href="https://beta.openai.com/docs/api-reference/completions/create">API Reference - OpenAI API</a></p>
<p>本程序的代码逻辑比较简单，请读者自行理解。</p>
<h2 id="WeRoBot"><a href="#WeRoBot" class="headerlink" title="WeRoBot"></a>WeRoBot</h2><p>WeRoBot 项目地址：<a target="_blank" rel="noopener" href="https://github.com/offu/WeRoBot">WeRoBot 是一个微信公众号开发框架</a></p>
<p>在本节，您将使用<strong>WeRoBot</strong>框架创建一个<strong>Hello World</strong>程序。</p>
<p>当您的公众号后台收到用户发来的消息时，程序会自动调用并发送<strong>Hello World</strong>，如下图所示。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://files.sunguoqi.com/images/202311250139832.webp">

<h3 id="安装-werobot-依赖"><a href="#安装-werobot-依赖" class="headerlink" title="安装 werobot 依赖"></a>安装 werobot 依赖</h3><p>使用<strong>ssh</strong>工具打开服务器终端并输入以下命令。</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">pip install werobot</span><br></pre></td></tr></tbody></table></figure>

<h3 id="新建-Python-脚本"><a href="#新建-Python-脚本" class="headerlink" title="新建 Python 脚本"></a>新建 Python 脚本</h3><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="built_in">touch</span> hello.py</span><br></pre></td></tr></tbody></table></figure>

<p>使用<strong>Vim</strong>打开<strong>hello.py</strong>文件，复制以下内容后保存。</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> werobot</span><br><span class="line"></span><br><span class="line">robot = werobot.WeRoBot(token=<span class="string">'tokenhere'</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@robot.handler</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello</span>(<span class="params">message</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'Hello World!'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 让服务器监听在 0.0.0.0:520</span></span><br><span class="line">robot.config[<span class="string">'HOST'</span>] = <span class="string">'0.0.0.0'</span></span><br><span class="line">robot.config[<span class="string">'PORT'</span>] = <span class="number">520</span></span><br><span class="line">robot.run()</span><br></pre></td></tr></tbody></table></figure>

<h3 id="运行该脚本"><a href="#运行该脚本" class="headerlink" title="运行该脚本"></a>运行该脚本</h3><p>运行该脚本之前，请确保您服务器的<code>520</code>端口已开放。</p>
<p>输入以下命令运行此脚本。</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">python3 ./hello.py </span><br></pre></td></tr></tbody></table></figure>

<p>终端输出如下。</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">Bottle v0.12.23 server starting up (using AutoServer())...</span><br><span class="line">Listening on http://0.0.0.0:520/</span><br><span class="line">Hit Ctrl-C to quit.</span><br></pre></td></tr></tbody></table></figure>

<h3 id="服务测试"><a href="#服务测试" class="headerlink" title="服务测试"></a>服务测试</h3><p>在浏览器中输入**http://{您服务器的公网ip}:{端口号}**访问此服务。</p>
<p>如果您看到如下界面，说明本服务已部署成功。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://files.sunguoqi.com/images/202311250139445.webp">

<h3 id="反向代理"><a href="#反向代理" class="headerlink" title="反向代理"></a>反向代理</h3><p>由于微信公众号的后台接口只支持<strong>80</strong>和<strong>443</strong>端口，故需要配置<strong>Nginx 反向代理</strong>。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://files.sunguoqi.com/images/202311250139593.webp">

<p>您可以使用<strong>宝塔面板</strong>或<strong>Nginx Proxy Manager</strong>配置反向代理，此处不做过多讲解。</p>
<p>当然，如果您服务器的<strong>80</strong>或<strong>443</strong>端口没有被占用的话，您可以直接将<strong>werobot</strong>运行在该端口下。</p>
<p>您只需要修改<strong>hello.py</strong>文件中该行代码<strong>robot.config[‘PORT’] = 80/443</strong>即可。</p>
<h3 id="公众号配置"><a href="#公众号配置" class="headerlink" title="公众号配置"></a>公众号配置</h3><p>打开微信公众平台，<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/">点我</a></p>
<p>在<strong>设置与开发</strong>选项卡中点击<strong>基本配置</strong>，输入您反向代理后的<strong>域名</strong>，设置您的<strong>令牌</strong>，消息加密点击<strong>自动生成</strong>，加密方式设置成<strong>明文</strong>。</p>
<p>请注意：这里的令牌必须和<strong>hello.py</strong>中的<strong>token</strong>保持一致。</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">robot = werobot.WeRoBot(token=<span class="string">'tokenhere'</span>)</span><br></pre></td></tr></tbody></table></figure>

<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://files.sunguoqi.com/images/202311250138792.webp">

<p>输入好配置后我们点击<strong>提交</strong>，然后<strong>启用</strong>该配置即可。</p>
<h3 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World !"></a>Hello World !</h3><p>不出意外的话，当用户在您的后台发送任何消息时，后台便会自动发送**Hello world`</p>
<h3 id="数据转发原理"><a href="#数据转发原理" class="headerlink" title="数据转发原理"></a>数据转发原理</h3><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://files.sunguoqi.com/images/202311250138991.webp">

<p>如上图所示，当在微信公众号后台发送消息时，数据首先会发送到微信服务器上，如果公众号后台配置了接口信息，那么<strong>微信服务器</strong>便会将数据转发到<strong>开发者服务器</strong>。由<strong>开发者服务器</strong>做出响应，再经过<strong>微信服务器</strong>发送到微信公众号客户端。</p>
<h2 id="ChatGPT-WeRoBot"><a href="#ChatGPT-WeRoBot" class="headerlink" title="ChatGPT &amp; WeRoBot"></a>ChatGPT &amp; WeRoBot</h2><p>首先，恭喜您已经完成了上面两个小节的内容。</p>
<p>在本节，我们将会把 ChatGPT 和 WeRoBot  融合成一个脚本，当用户输入信息时，后台响应的不再是**Hello World`，而是经过 ChatGPT 处理后的结果。</p>
<h3 id="编写代码"><a href="#编写代码" class="headerlink" title="编写代码"></a>编写代码</h3><p>在服务器中新建<strong>chatgpt.py</strong>文件，并将以下代码复制到该文件中。</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> werobot</span><br><span class="line"><span class="keyword">import</span> openai</span><br><span class="line"></span><br><span class="line">robot = werobot.WeRoBot(token=<span class="string">'你的 Token'</span>)</span><br><span class="line"></span><br><span class="line">openai.api_key = <span class="string">"你的 api_key"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_response</span>(<span class="params">prompt</span>):</span><br><span class="line">&nbsp; &nbsp; response = openai.Completion.create(</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; model = <span class="string">"text-davinci-003"</span>,</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; prompt = prompt,</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; max_tokens = <span class="number">1000</span>,</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; temperature = <span class="number">0.5</span>,</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; top_p = <span class="number">1</span>,</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; frequency_penalty = <span class="number">0.0</span>,</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; presence_penalty = <span class="number">0.0</span>,</span><br><span class="line">&nbsp; &nbsp; )</span><br><span class="line">&nbsp; &nbsp; message = response.choices[<span class="number">0</span>].text</span><br><span class="line">&nbsp; &nbsp; <span class="keyword">return</span> message.strip()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@robot.handler</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello</span>(<span class="params">message</span>):</span><br><span class="line">&nbsp; &nbsp; <span class="keyword">return</span> generate_response(message.content)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 本程序将在 520 端口运行</span></span><br><span class="line">robot.config[<span class="string">'HOST'</span>] = <span class="string">'0.0.0.0'</span> </span><br><span class="line">robot.config[<span class="string">'PORT'</span>] = <span class="number">520</span></span><br><span class="line">robot.run()</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<h3 id="进程管理"><a href="#进程管理" class="headerlink" title="进程管理"></a>进程管理</h3><p>当我们关掉<strong>ssh 会话</strong>连接时，我们在此会话中运行的进程便会被杀死，如何解决这个问题呢？</p>
<p>这里推荐大家使用<strong>Screen</strong>对进程进行管理，常用命令如下。</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">安装：</span><br><span class="line">	<span class="comment">#CentOS系统安装命令</span></span><br><span class="line">	yum install screen</span><br><span class="line"> </span><br><span class="line">	<span class="comment">#Debian/Ubuntu安装命令</span></span><br><span class="line">	apt-get install screen</span><br><span class="line"></span><br><span class="line">创建：</span><br><span class="line">	<span class="comment"># 新建 screen</span></span><br><span class="line">	screen -S&nbsp;your_screen_name</span><br><span class="line"></span><br><span class="line">查看：</span><br><span class="line">	<span class="comment"># 查看 screen 列表</span></span><br><span class="line">	screen -<span class="built_in">ls</span></span><br><span class="line"></span><br><span class="line">进入：</span><br><span class="line">	<span class="comment"># 进入 screen</span></span><br><span class="line">	screen -r xxx</span><br><span class="line"></span><br><span class="line">删除：</span><br><span class="line">	<span class="comment"># 在当前screen下，输入Ctrl+D，删除该screen</span></span><br><span class="line">	Ctrl+D</span><br><span class="line"></span><br><span class="line">退出：</span><br><span class="line">	<span class="comment"># 在当前screen下，输入先后Ctrl+A，Ctrl+D，退出该screen</span></span><br><span class="line">	Ctrl+A，Ctrl+D</span><br><span class="line"></span><br><span class="line">杀死：</span><br><span class="line">	<span class="comment"># 删除指定screen, your_screen_name为待删除的screen name</span></span><br><span class="line">	screen -S your_screen_name&nbsp;-X quit</span><br></pre></td></tr></tbody></table></figure>

<h3 id="运行服务"><a href="#运行服务" class="headerlink" title="运行服务"></a>运行服务</h3><p>确保您服务器的<strong>520</strong>端口 (端口号以实际开发为准) 已开放，且没被占用。</p>
<p>在终端中输入以下命令，创建一个<code>screen</code>。</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">screen -S chatgpt</span><br></pre></td></tr></tbody></table></figure>

<p>进入<code>screen</code>后，输入以下命令运行<code>chatgpt.py</code>即可。</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">python3 ./chatgpt.py</span><br></pre></td></tr></tbody></table></figure>


<h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><h3 id="科学上网"><a href="#科学上网" class="headerlink" title="科学上网"></a>科学上网</h3><p>由于敏感原因，请确保您的电脑和服务器都可以正常访问境外网络。</p>
<h3 id="账号注册"><a href="#账号注册" class="headerlink" title="账号注册"></a>账号注册</h3><p>OpenAI 账号注册可参考此教程 <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/589642999">OpenAI ChatGPT 注册保姆级攻略，绝对有效 - 知乎 (zhihu.com)</a></p>
<h3 id="微信公众号自定义菜单及关键词回复失效"><a href="#微信公众号自定义菜单及关键词回复失效" class="headerlink" title="微信公众号自定义菜单及关键词回复失效"></a>微信公众号自定义菜单及关键词回复失效</h3><p>由于我们使用了自定义的接口，便无法再使用官方提供的<strong>自定义菜单</strong>及<strong>关键词回复</strong>等功能。</p>
<p>二者功能实现可参考<strong>WeRoBot</strong>文档自行开发。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://files.sunguoqi.com/images/202311250137197.webp">

<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://files.sunguoqi.com/images/202311250137084.webp">


<h3 id="该公众号提供的服务出现故障，请稍后再试！"><a href="#该公众号提供的服务出现故障，请稍后再试！" class="headerlink" title="该公众号提供的服务出现故障，请稍后再试！"></a>该公众号提供的服务出现故障，请稍后再试！</h3><p>微信官方为了优化用户体验，对接口制定了如下规则：</p>
<blockquote>
<p>微信服务器在五秒内如果收不到开发者服务器的响应便会主动断掉连接，并且重新发起请求，总共重试三次。</p>
</blockquote>
<p>此规则会对本程序带来一定的限制，如果用户输入的文本较为复杂或者 ChatGPT 较难处理的话，服务器的响应时间通常会超过 5s，客户端便会收到<strong>该公众号提供的服务出现故障，请稍后再试</strong>的消息。</p>
<p>未认证的公众号暂时无法突破此限制（已认证的公众号可以采取被动模式接收消息，待程序处理完成后使用主动模式进行发送消息的方法突破此限制）。</p>
<p>对于用户而言，建议您采用<strong>英语</strong>进行提问，并且<strong>精炼</strong>您的语言，以避免 ChatGPT 处理复杂文本而超时。</p>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/avatar.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/avatar.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">小孙同学</div><div class="post-copyright__author_desc">热爱可抵岁月漫长</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="https://blog.sunguoqi.com/posts/e78a2007/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('https://blog.sunguoqi.com/posts/e78a2007/')">快速上手，教你如何将 ChatGPT 接入到微信公众号</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="https://files.sunguoqi.com/images/202311250236396.webp" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://files.sunguoqi.com/images/202311250236396.webp" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://files.sunguoqi.com/images/202311250235039.webp" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://files.sunguoqi.com/images/202311250235039.webp" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div><div class="reward-link mode"><a class="reward-link-button" href="/operation/"><i class="anzhiyufont anzhiyu-icon-plant-fill"></i>运营模式与责任</a></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="https://blog.sunguoqi.com/posts/e78a2007/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=快速上手，教你如何将 ChatGPT 接入到微信公众号&amp;url=https://blog.sunguoqi.com/posts/e78a2007/&amp;pic=https://files.sunguoqi.com/images/202311220232967.webp" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.sunguoqi.com" target="_blank">小孙同学</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/%E5%BC%80%E5%8F%91/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>开发<span class="tagsPageCount">2</span></a><a class="post-meta__box__tags" href="/tags/%E7%83%AD%E9%97%A8/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>热门<span class="tagsPageCount">2</span></a><a class="post-meta__box__tags" href="/tags/AI/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>AI<span class="tagsPageCount">1</span></a><a class="post-meta__box__tags" href="/tags/%E6%95%99%E7%A8%8B/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>教程<span class="tagsPageCount">3</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://files.sunguoqi.com/images/202401030045075.webp" data-sites="facebook,twitter,wechat,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/1db87a14/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://files.sunguoqi.com/images/202311220236935.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">请接受像“屎”一样的开始</div></div></a></div><div class="next-post pull-right"><a href="/posts/f3b61b38/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://files.sunguoqi.com/images/202311220231908.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">让面试官眼前一亮，手把手带你打造个性化的 GitHub 首页</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/posts/f3b61b38/" title="让面试官眼前一亮，手把手带你打造个性化的 GitHub 首页"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://files.sunguoqi.com/images/202311220231908.webp" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-01-30</div><div class="title">让面试官眼前一亮，手把手带你打造个性化的 GitHub 首页</div></div></a></div><div><a href="/posts/defe59e4/" title="使用 Flask 快速构建豆瓣图书&#x2F;电影海报 WebAPI"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://files.sunguoqi.com/images/202312091441958.webp" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-01-09</div><div class="title">使用 Flask 快速构建豆瓣图书&#x2F;电影海报 WebAPI</div></div></a></div><div><a href="/posts/3eb6a074/" title="Oh My Posh | Windows Terminal 美化指南"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://files.sunguoqi.com/images/202311220244903.webp" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-07-15</div><div class="title">Oh My Posh | Windows Terminal 美化指南</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> 评论</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">匿名评论</a><a href="/privacy" style="margin-left: 4px">隐私政策</a></div><div class="comment-tips" id="comment-tips"><span>✅ 你无需删除空行，直接评论以获取最佳展示效果</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/08/24/64e6ce9c507bb.png" alt="status"/></div></div><div class="author-info__description"><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">这里有关于<b style="color:#fff">编程、摄影、生活</b>等相关问题的思考和看法，还有<b style="color:#fff">日常碎碎念</b>和<b style="color:#fff">资源分享</b><br></div><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">持续创作，不定期更新～<br><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">希望你可以在这里找到对你有用的<b style="color:#fff">知识</b>、<b style="color:#fff">内容</b>、和<b style="color:#fff">灵感</b></div></div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">小孙同学</h1><div class="author-info__desc">热爱可抵岁月漫长</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://twitter.com/sun0225SUN" target="_blank" title="Twitter"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-x"></use></svg></a><a class="social-icon faa-parent animated-hover" href="https://github.com/sun0225SUN" target="_blank" title="Github"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-github"></use></svg></a></div></div></div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://files.sunguoqi.com/images/202311250251536.webp) center center / 100% no-repeat"></div><div class="back face" style="background: url(https://files.sunguoqi.com/images/202311250254539.webp) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%88%90%E6%9E%9C%E6%BC%94%E7%A4%BA"><span class="toc-number">1.</span> <span class="toc-text">成果演示</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E9%97%AE%E7%AD%94"><span class="toc-number">1.1.</span> <span class="toc-text">基础问答</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E8%A7%A3%E8%AF%BB"><span class="toc-number">1.2.</span> <span class="toc-text">代码解读</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E8%BD%AC%E6%8D%A2"><span class="toc-number">1.3.</span> <span class="toc-text">代码转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%94%99%E8%AF%AF%E4%BF%AE%E6%AD%A3"><span class="toc-number">1.4.</span> <span class="toc-text">错误修正</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%83%85%E6%84%9F%E5%88%86%E6%9E%90"><span class="toc-number">1.5.</span> <span class="toc-text">情感分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E5%88%86%E7%B1%BB"><span class="toc-number">1.6.</span> <span class="toc-text">项目分类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8D%E5%AD%97%E7%94%9F%E6%88%90%E5%99%A8"><span class="toc-number">1.7.</span> <span class="toc-text">名字生成器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6%E8%AE%A1%E7%AE%97"><span class="toc-number">1.8.</span> <span class="toc-text">时间复杂度计算</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8B%E6%83%85%E6%8F%90%E7%A4%BA"><span class="toc-number">2.</span> <span class="toc-text">友情提示</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OpenAI-API"><span class="toc-number">3.</span> <span class="toc-text">OpenAI API</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B0%E5%BB%BA%E4%B8%80%E4%B8%AA-Python-%E9%A1%B9%E7%9B%AE"><span class="toc-number">3.1.</span> <span class="toc-text">新建一个 Python 项目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B0%E5%BB%BA%E4%B8%80%E4%B8%AA-API-key"><span class="toc-number">3.2.</span> <span class="toc-text">新建一个 API key</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-openai-%E4%BE%9D%E8%B5%96"><span class="toc-number">3.3.</span> <span class="toc-text">安装 openai 依赖</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E5%A4%B1%E8%B4%A5"><span class="toc-number">3.3.1.</span> <span class="toc-text">安装失败</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E6%88%90%E5%8A%9F"><span class="toc-number">3.3.2.</span> <span class="toc-text">安装成功</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E7%A4%BA%E4%BE%8B%E5%BA%94%E7%94%A8"><span class="toc-number">3.4.</span> <span class="toc-text">查看示例应用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%AC%E5%9C%B0%E8%B0%83%E8%AF%95"><span class="toc-number">3.5.</span> <span class="toc-text">本地调试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E8%A7%A3%E8%AF%BB-1"><span class="toc-number">3.6.</span> <span class="toc-text">代码解读</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WeRoBot"><span class="toc-number">4.</span> <span class="toc-text">WeRoBot</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-werobot-%E4%BE%9D%E8%B5%96"><span class="toc-number">4.1.</span> <span class="toc-text">安装 werobot 依赖</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B0%E5%BB%BA-Python-%E8%84%9A%E6%9C%AC"><span class="toc-number">4.2.</span> <span class="toc-text">新建 Python 脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%90%E8%A1%8C%E8%AF%A5%E8%84%9A%E6%9C%AC"><span class="toc-number">4.3.</span> <span class="toc-text">运行该脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E6%B5%8B%E8%AF%95"><span class="toc-number">4.4.</span> <span class="toc-text">服务测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86"><span class="toc-number">4.5.</span> <span class="toc-text">反向代理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%AC%E4%BC%97%E5%8F%B7%E9%85%8D%E7%BD%AE"><span class="toc-number">4.6.</span> <span class="toc-text">公众号配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hello-World"><span class="toc-number">4.7.</span> <span class="toc-text">Hello World !</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E8%BD%AC%E5%8F%91%E5%8E%9F%E7%90%86"><span class="toc-number">4.8.</span> <span class="toc-text">数据转发原理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ChatGPT-WeRoBot"><span class="toc-number">5.</span> <span class="toc-text">ChatGPT &amp; WeRoBot</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E5%86%99%E4%BB%A3%E7%A0%81"><span class="toc-number">5.1.</span> <span class="toc-text">编写代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86"><span class="toc-number">5.2.</span> <span class="toc-text">进程管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%90%E8%A1%8C%E6%9C%8D%E5%8A%A1"><span class="toc-number">5.3.</span> <span class="toc-text">运行服务</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">6.</span> <span class="toc-text">注意事项</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91"><span class="toc-number">6.1.</span> <span class="toc-text">科学上网</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B4%A6%E5%8F%B7%E6%B3%A8%E5%86%8C"><span class="toc-number">6.2.</span> <span class="toc-text">账号注册</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7%E8%87%AA%E5%AE%9A%E4%B9%89%E8%8F%9C%E5%8D%95%E5%8F%8A%E5%85%B3%E9%94%AE%E8%AF%8D%E5%9B%9E%E5%A4%8D%E5%A4%B1%E6%95%88"><span class="toc-number">6.3.</span> <span class="toc-text">微信公众号自定义菜单及关键词回复失效</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%A5%E5%85%AC%E4%BC%97%E5%8F%B7%E6%8F%90%E4%BE%9B%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%87%BA%E7%8E%B0%E6%95%85%E9%9A%9C%EF%BC%8C%E8%AF%B7%E7%A8%8D%E5%90%8E%E5%86%8D%E8%AF%95%EF%BC%81"><span class="toc-number">6.4.</span> <span class="toc-text">该公众号提供的服务出现故障，请稍后再试！</span></a></li></ol></li></ol></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="footer_deal"><a class="deal_link" href="mailto:2516943693@qq.com" title="email"><i class="fa-solid fa-envelope"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://mp.sunguoqi.com/" title="WeChat"><i class="fa-brands fa-weixin"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://files.sunguoqi.com/images/202312221148345.webp" title="Tiktok"><i class="fa-brands fa-tiktok"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://space.bilibili.com/448488855/" title="Bilibili"><i class="fa-brands fa-bilibili"></i></a><img class="footer_mini_logo" title="返回顶部" alt="返回顶部" onclick="anzhiyu.scrollToDest(0, 500)" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/avatar.jpg" size="50px"/><a class="deal_link" target="_blank" rel="noopener" href="https://twitter.com/sun0225SUN" title="Twitter"><i class="fa-brands fa-twitter"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/sun0225SUN" title="Github"><i class="fa-brands fa-github"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://www.youtube.com/@sun0225SUN" title="YouTube"><i class="fa-brands fa-youtube"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://t.me/sun0225SUN" title="Telegram"><i class="fa-brands fa-telegram"></i></a></div><div id="anzhiyu-footer"><div class="footer-group"><div class="footer-title">服务</div><div class="footer-links"><a class="footer-item" title="51la 统计" target="_blank" rel="noopener" href="https://v6.51.la/">51la 统计</a><a class="footer-item" title="十年之约" target="_blank" rel="noopener" href="https://www.foreverblog.cn/">十年之约</a><a class="footer-item" title="开往" target="_blank" rel="noopener" href="https://github.com/travellings-link/travellings">开往</a></div></div><div class="footer-group"><div class="footer-title">主题</div><div class="footer-links"><a class="footer-item" title="文档" href="/docs/">文档</a><a class="footer-item" title="源码" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu">源码</a><a class="footer-item" title="更新日志" href="/update/">更新日志</a></div></div><div class="footer-group"><div class="footer-title">导航</div><div class="footer-links"><a class="footer-item" title="即刻短文" href="/essay/">即刻短文</a><a class="footer-item" title="友链文章" href="/fcircle/">友链文章</a><a class="footer-item" title="留言板" href="/comments/">留言板</a></div></div><div class="footer-group"><div class="footer-title">协议</div><div class="footer-links"><a class="footer-item" title="隐私协议" href="/privacy/">隐私协议</a><a class="footer-item" title="运营模式" href="/operation/">运营模式</a><a class="footer-item" title="版权协议" href="/copyright/">版权协议</a></div></div><div class="footer-group"><div class="footer-title-group"><div class="footer-title">友链</div><a class="random-friends-btn" id="footer-random-friends-btn" href="javascript:addFriendLinksInFooter();" title="换一批友情链接"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right"></i></a></div><div class="footer-links" id="friend-links-in-footer"></div></div></div></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2023 - 2024 By <a class="footer-bar-link" href="/" title="小孙同学" target="_blank">小孙同学</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" href="https://blog.sunguoqi.com/rss.xml" title="订阅">订阅</a><a class="footer-bar-link" target="_blank" rel="noopener" href="https://beian.miit.gov.cn/" title="皖 ICP 备 2021010058 号">皖 ICP 备 2021010058 号</a><a class="footer-bar-link" target="_blank" rel="noopener" href="https://beian.mps.gov.cn/" title="皖公网安备 34040302000393">皖公网安备 34040302000393</a><a class="footer-bar-link cc" href="/copyright" title="cc协议"><i class="anzhiyufont anzhiyu-icon-copyright-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-by-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-nc-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-nd-line"></i></a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">12</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">25</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">7</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网站</div><div class="back-menu-list"><a class="back-menu-item" href="https://blog.sunguoqi.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/favicon.png" alt="博客"/><span class="back-menu-item-text">博客</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://brain.sunguoqi.com/" title="外脑"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://files.sunguoqi.com/images/202312110649164.webp" alt="外脑"/><span class="back-menu-item-text">外脑</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://chat.sunguoqi.com/" title="Chat"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://files.sunguoqi.com/images/202312110652765.webp" alt="Chat"/><span class="back-menu-item-text">Chat</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li><li><a class="site-page child faa-parent animated-hover" target="_blank" rel="noopener" href="https://brain.sunguoqi.com"><i class="anzhiyufont anzhiyu-icon-fire faa-tada" style="font-size: 0.9em;"></i><span> 外脑</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 生活</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/essay/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-bulb"></use></svg><span> 说说</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-images"></use></svg><span> 相册</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/music/?id=4863092223&amp;server=netease"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐</span></a></li><li><a class="site-page child faa-parent animated-hover" target="_blank" rel="noopener" href="https://run.sunguoqi.com"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-run"></use></svg><span> 运动</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 工具</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" target="_blank" rel="noopener" href="https://v6.51.la/s/Jvt3I1rYnN7Z9TW"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-data"></use></svg><span> 流量统计</span></a></li><li><a class="site-page child faa-parent animated-hover" target="_blank" rel="noopener" href="https://stats.uptimerobot.com/4oYGZiYEQZ"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-check"></use></svg><span> 服务监控</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/equipment/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-bag"></use></svg><span> 日常装备</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/collect/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-box"></use></svg><span> 收藏推荐</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-link"></use></svg><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-pyq"></use></svg><span> 朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-comments"></use></svg><span> 留言板</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/about/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-about"></use></svg><span> 关于我</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/21-%E5%B2%81/" style="font-size: 0.88rem;">21 岁<sup>1</sup></a><a href="/tags/22-%E5%B2%81/" style="font-size: 0.88rem;">22 岁<sup>1</sup></a><a href="/tags/AI/" style="font-size: 0.88rem;">AI<sup>1</sup></a><a href="/tags/Flask/" style="font-size: 0.88rem;">Flask<sup>1</sup></a><a href="/tags/GitHub/" style="font-size: 0.88rem;">GitHub<sup>1</sup></a><a href="/tags/%E5%85%AC%E4%BC%97%E5%8F%B7/" style="font-size: 0.88rem;">公众号<sup>1</sup></a><a href="/tags/%E5%8D%9A%E5%AE%A2/" style="font-size: 0.88rem;">博客<sup>1</sup></a><a href="/tags/%E5%A4%96%E8%84%91/" style="font-size: 0.88rem;">外脑<sup>1</sup></a><a href="/tags/%E5%A5%BD%E7%89%A9%E6%8E%A8%E8%8D%90/" style="font-size: 0.88rem;">好物推荐<sup>1</sup></a><a href="/tags/%E5%AD%A6%E4%B9%A0/" style="font-size: 0.88rem;">学习<sup>1</sup></a><a href="/tags/%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/" style="font-size: 0.88rem;">年终总结<sup>1</sup></a><a href="/tags/%E5%BC%80%E5%8F%91/" style="font-size: 0.88rem;">开发<sup>2</sup></a><a href="/tags/%E6%84%9F%E6%82%9F/" style="font-size: 0.88rem;">感悟<sup>3</sup></a><a href="/tags/%E6%88%90%E9%95%BF/" style="font-size: 0.88rem;">成长<sup>1</sup></a><a href="/tags/%E6%91%84%E5%BD%B1/" style="font-size: 0.88rem;">摄影<sup>1</sup></a><a href="/tags/%E6%95%99%E7%A8%8B/" style="font-size: 0.88rem;">教程<sup>3</sup></a><a href="/tags/%E6%97%85%E8%A1%8C/" style="font-size: 0.88rem;">旅行<sup>1</sup></a><a href="/tags/%E7%83%AD%E9%97%A8/" style="font-size: 0.88rem;">热门<sup>2</sup></a><a href="/tags/%E7%94%9F%E6%97%A5/" style="font-size: 0.88rem;">生日<sup>2</sup></a><a href="/tags/%E7%94%9F%E6%B4%BB/" style="font-size: 0.88rem;">生活<sup>5</sup></a><a href="/tags/%E7%B2%BE%E9%80%89/" style="font-size: 0.88rem;">精选<sup>1</sup></a><a href="/tags/%E7%BB%88%E7%AB%AF/" style="font-size: 0.88rem;">终端<sup>1</sup></a><a href="/tags/%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB/" style="font-size: 0.88rem;">网络爬虫<sup>1</sup></a><a href="/tags/%E7%BE%8E%E5%8C%96/" style="font-size: 0.88rem;">美化<sup>2</sup></a><a href="/tags/%E8%BF%90%E8%90%A5/" style="font-size: 0.88rem;">运营<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><a id="switch-commentBarrage" href="javascript:anzhiyu.switchCommentBarrage();" title="开关弹幕"><i class="anzhiyufont anzhiyu-icon-danmu"></i></a><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="3220109697" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="is-center" id="loading-database"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-pulse-icon"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://music.163.com/#/playlist?id=4863092223&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.cbd.int/pangu@4.0.7/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script async src="/anzhiyu/random.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(() => {
  const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaid.length === 0) return
  const runMermaid = () => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    Array.from($mermaid).forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
      const mermaidID = 'mermaid-' + index
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)

      const renderV10 = () => {
        renderFn.then(({svg}) => {
          mermaidSrc.insertAdjacentHTML('afterend', svg)
        })
      }

      const renderV9 = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      typeof renderFn === 'string' ? renderV9(renderFn) : renderV10()
    })
  }

  const loadMermaid = () => {
    window.loadMermaid ? runMermaid() : getScript('https://cdn.cbd.int/mermaid@10.2.4/dist/mermaid.min.js').then(runMermaid)
  }

  anzhiyu.addGlobalFn('themeChange', runMermaid, 'mermaid')

  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><script>(() => {
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://twikoo-sun.netlify.app/.netlify/functions/twikoo',
      region: '',
      onCommentLoaded: () => {
        anzhiyu.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') setTimeout(runFn,0)
    else getScript('https://cdn.cbd.int/twikoo@1.6.27/dist/twikoo.all.min.js').then(runFn)
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoo-sun.netlify.app/.netlify/functions/twikoo',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const runFn = () => {
    init();
    GLOBAL_CONFIG_SITE.isPost && getCount()
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) anzhiyu.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else {
      loadTwikoo()
    }
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"><script async src="/js/anzhiyu/comment_barrage.js"></script></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    const runTwikoo = () => {
      twikoo.getRecentComments({
        envId: 'https://twikoo-sun.netlify.app/.netlify/functions/twikoo',
        region: '',
        pageSize: 6,
        includeReply: true
      }).then(function (res) {
        const twikooArray = res.map(e => {
          return {
            'content': changeContent(e.comment),
            'avatar': e.avatar,
            'nick': e.nick,
            'url': e.url + '#' + e.id,
            'date': new Date(e.created).toISOString()
          }
        })

        saveToLocal.set('twikoo-newest-comments', JSON.stringify(twikooArray), 10/(60*24))
        generateHtml(twikooArray)
      }).catch(function (err) {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.textContent= "无法获取评论，请确认相关配置是否正确"
      })
    }

    if (typeof twikoo === 'object') {
      runTwikoo()
    } else {
      getScript('https://cdn.cbd.int/twikoo@1.6.27/dist/twikoo.all.min.js').then(runTwikoo)
    }
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'><div class='name'><span>${array[i].nick} </span></div></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom && ($dom.innerHTML= result)
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('twikoo-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script>var visitorMail = "visitor@sunguoqi.com";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><script async src="//at.alicdn.com/t/c/font_4184660_xd0m109eeb.js"></script><script src="/js/danmu.js"></script><script src="/js/custom.js"></script><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","meta[property=\"og:type\"]","meta[property=\"og:site_name\"]","meta[property=\"og:description\"]","head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>